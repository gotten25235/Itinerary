<!-- filename: index.html -->
<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- ★ 預設標題：載入後會由 handle.js 依「標題偵測 / 工作表名稱」覆蓋 -->
  <title>Sheet Viewer</title>

  <!-- ★ 預覽/分享用描述（避免 LINE/FB 自動抓頁面正文按鈕文字當描述） -->
  <meta name="description" content="Sheet Viewer：支援 Grid / List / Schedule 檢視，讀取 Google Sheets 匯出的 CSV，適合行程與清單快速瀏覽。" />

  <!-- ★ Open Graph（LINE/FB 等預覽會優先用這些） -->
  <meta property="og:title" content="Sheet Viewer" />
  <meta property="og:description" content="Sheet Viewer：支援 Grid / List / Schedule 檢視，讀取 Google Sheets 匯出的 CSV，適合行程與清單快速瀏覽。" />
  <meta property="og:type" content="website" />
  <!-- 若你有固定網址，建議填上，預覽更穩定 -->
  <!-- <meta property="og:url" content="https://your-domain/your-page" /> -->
  <!-- 若你有預覽圖，建議填上 -->
  <!-- <meta property="og:image" content="https://your-domain/og.png" /> -->

  <!-- ★ Twitter Card（可選） -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Sheet Viewer" />
  <meta name="twitter:description" content="Sheet Viewer：支援 Grid / List / Schedule 檢視，讀取 Google Sheets 匯出的 CSV，適合行程與清單快速瀏覽。" />
  <!-- <meta name="twitter:image" content="https://your-domain/og.png" /> -->

  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <!-- ★ 預設顯示：載入後會由 handle.js 覆蓋成偵測到的標題/工作表名稱 -->
  <h2 id="pageTitle">檢視器</h2>

  <!-- 控制列：提供 Google Sheets CSV 模板 + gid + 載入/範例按鈕 -->
  <div class="controls" role="region" aria-label="controls">
    <input id="csvTemplate" class="tmpl" type="text"
      value="https://docs.google.com/spreadsheets/d/{gid}/export?format=csv"
      title="URL 範本，可放 {gid}">
    <input id="gidInput" class="gid" type="text" placeholder="輸入 GID" title="gid (ex: 2080236062)">

    <button id="openCsv" type="button">在新分頁開啟 CSV</button>
    <button id="loadBtn" type="button">載入資料</button>
    <button id="reloadBtn" type="button">重新載入</button>
    <button id="loadSampleBtn" type="button">載入範例</button>
  </div>

  <!-- 狀態列 -->
  <div class="status-row">
    <div id="status" class="status-box">尚未載入</div>
  </div>

  <!-- 檢視切換按鈕容器（由 JS 動態建立） -->
  <div id="viewToggle" class="view-toggle" aria-label="view-toggles"></div>

  <!-- 資料輸出區 -->
  <div id="out" class="groups" aria-live="polite"></div>

  <div class="note">
    提示：若遠端 CSV 權限/CORS 失敗，頁面不會自動顯示範例；可按「載入範例」手動檢視。
    「模式/備註」建議放在表格前兩列；含「時刻表」的那一列將被視為真正表頭。
  </div>

  <!-- 重要：腳本載入順序（先工具，再各視圖，最後 handle） -->
  <script src="js/csv-parser.js"></script>
  <script src="js/view-card-base.js"></script>
  <script src="js/utils-copy.js"></script>

  <script src="js/view-raw.js"></script>
  <script src="js/view-grid.js"></script>
  <script src="js/view-list.js"></script>
  <script src="js/view-schedule.js"></script>
  <script src="js/view-shopping.js"></script>
  <script src="js/view-note.js"></script>

  <script src="js/schedule-mobile.js"></script>
  <script src="js/handle.js"></script>
</body>
</html>
